<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hudl Tickets Lookup | Support Suite</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { background-color: #0f172a; color: #f8fafc; font-family: ui-sans-serif, system-ui, sans-serif; }
  .card { background-color: #1e293b; border: 1px solid #334155; }
  input, select, textarea { background: #0f172a; border: 1px solid #334155; color: white; outline: none; }
  input:focus, select:focus, textarea:focus { border-color: #f97316; }
  tr:hover td { background-color: rgba(255,255,255,0.015); }
</style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState } = React;

// ‚îÄ‚îÄ‚îÄ Mock Data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const MOCK_ORDERS = [
  {
    orderNumber: "gh4b4t24mxqe",
    id: "VGlja2V0R3JvdXA2ODdlNzFhMzYzMjEyOGExYzYwYjI1ZTk=",
    userId: "26806767",
    firstName: "Janet",
    lastName: "Jones",
    email: "rjjfriday@aol.com",
    orderTotal: 80.00,
    currency: "USD",
    itemCategories: "Pass",
    source: "Mobile",
    createdAt: "2025-07-21T16:58:11.452Z",
    updatedAt: "2025-08-27T22:22:22.270Z",
    deletedAt: null,
    originalTicketGroup: null,
    status: "Active",
    passes: [
      { passId: "UGFzczY4N2U3MWEzNjMyMTI4YTFjNjBiMjVlNw==", passConfigId: "UGFzc0NvbmZpZzY4NGFkZjI4ZDEyMGQ5YTMwMzk3NjNiYQ==", source: "Mobile", reservedSeats: null },
      { passId: "UGFzczY4N2U3MWEzNjMyMTI4YTFjNjBiMjVlOA==", passConfigId: "UGFzc0NvbmZpZzY4NGFkZjI4ZDEyMGQ5YTMwMzk3NjNiYQ==", source: "Mobile", reservedSeats: null }
    ],
    transferHistory: []
  },
  {
    orderNumber: "ab1c2d34efgh",
    id: "VGlja2V0R3JvdXBhYjFjMmQzNGVmZ2gxMjM0NTY3ODk=",
    userId: "19283746",
    firstName: "Michael",
    lastName: "Torres",
    email: "mtorres@gmail.com",
    orderTotal: 10.60,
    currency: "USD",
    itemCategories: "Single Game",
    source: "Web",
    createdAt: "2026-01-15T20:30:00.000Z",
    updatedAt: "2026-01-15T21:05:33.000Z",
    deletedAt: null,
    originalTicketGroup: null,
    status: "Refunded",
    passes: [
      { passId: "UGFzczE5MjgzNzQ2YWIxYzJkMzRlZmdoMTIz", passConfigId: "UGFzc0NvbmZpZzE5MjgzNzQ2YWIxYzJkMzRlZmdoMTIz", source: "Web", reservedSeats: null }
    ],
    transferHistory: []
  },
  {
    orderNumber: "xy9z8w76vuqr",
    id: "VGlja2V0R3JvdXB4eTl6OHc3NnZ1cXIxMjM0NTY3ODk=",
    userId: "38475610",
    firstName: "Sarah",
    lastName: "Mitchell",
    email: "sarah.m@yahoo.com",
    orderTotal: 42.00,
    currency: "USD",
    itemCategories: "Season Pass",
    source: "Mobile",
    createdAt: "2025-09-01T14:00:00.000Z",
    updatedAt: "2025-11-10T18:00:00.000Z",
    deletedAt: null,
    originalTicketGroup: null,
    status: "Active",
    passes: [
      { passId: "UGFzczM4NDc1NjEweHk5ejh3NzZ2dXFyMTIz", passConfigId: "UGFzc0NvbmZpZzM4NDc1NjEweHk5ejh3NzZ2dXFyMTIz", source: "Mobile", reservedSeats: null },
      { passId: "UGFzczM4NDc1NjEweHk5ejh3NzZ2dXFyNDU2", passConfigId: "UGFzc0NvbmZpZzM4NDc1NjEweHk5ejh3NzZ2dXFyNDU2", source: "Mobile", reservedSeats: "Row C, Seat 12" }
    ],
    transferHistory: [
      { date: "2025-10-15T09:00:00.000Z", from: "sarah.m@yahoo.com", to: "mark.mitchell@gmail.com", passId: "UGFzczM4NDc1NjEweHk5ejh3NzZ2dXFyNDU2", action: "Transfer" }
    ]
  },
  {
    orderNumber: "mn5p6q78rstu",
    id: "VGlja2V0R3JvdXBtbjVwNnE3OHJzdHUxMjM0NTY3ODk=",
    userId: "47382910",
    firstName: "David",
    lastName: "Chen",
    email: "dchen@hotmail.com",
    orderTotal: 14.99,
    currency: "USD",
    itemCategories: "Single Game",
    source: "Web",
    createdAt: "2026-02-10T11:00:00.000Z",
    updatedAt: "2026-02-10T11:00:00.000Z",
    deletedAt: null,
    originalTicketGroup: null,
    status: "Active",
    passes: [
      { passId: "UGFzczQ3MzgyOTEwbW41cDZxNzhyc3R1MTIz", passConfigId: "UGFzc0NvbmZpZzQ3MzgyOTEwbW41cDZxNzhyc3R1MTIz", source: "Web", reservedSeats: null }
    ],
    transferHistory: []
  },
  {
    orderNumber: "rp2q3r45stuv",
    id: "VGlja2V0R3JvdXBycDJxM3I0NXN0dXYxMjM0NTY3ODk=",
    userId: "55019283",
    firstName: "Linda",
    lastName: "Park",
    email: "linda.park82@outlook.com",
    orderTotal: 80.00,
    currency: "USD",
    itemCategories: "Pass",
    source: "Mobile",
    createdAt: "2026-02-18T19:10:00.000Z",
    updatedAt: "2026-02-18T19:10:00.000Z",
    deletedAt: null,
    originalTicketGroup: null,
    status: "Active",
    passes: [
      { passId: "UGFzzNTUwMTkyODNycDJxM3I0NXN0dXYxMjM=", passConfigId: "UGFzc0NvbmZpZzU1MDE5MjgzcnAycTNyNDVzdHV2MTIz", source: "Mobile", reservedSeats: null },
      { passId: "UGFzzNTUwMTkyODNycDJxM3I0NXN0dXY0NTY=", passConfigId: "UGFzc0NvbmZpZzU1MDE5MjgzcnAycTNyNDVzdHV2NDU2", source: "Mobile", reservedSeats: null }
    ],
    transferHistory: []
  }
];

// ‚îÄ‚îÄ‚îÄ Utilities ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const fmt = (isoStr) => {
  if (!isoStr) return "‚Äî";
  const d = new Date(isoStr);
  return d.toLocaleString("en-US", { dateStyle: "medium", timeStyle: "short" });
};

const fmtDate = (isoStr) => {
  if (!isoStr) return "‚Äî";
  return isoStr.split("T")[0];
};

const copyToClipboard = (text) => {
  if (!text || text === "‚Äî") return;
  navigator.clipboard.writeText(text).catch(() => {
    const ta = document.createElement("textarea");
    ta.value = text;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand("copy");
    document.body.removeChild(ta);
  });
};

// ‚îÄ‚îÄ‚îÄ Small components ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const CopyBtn = ({ text }) => {
  const [copied, setCopied] = useState(false);
  const handle = () => {
    copyToClipboard(text);
    setCopied(true);
    setTimeout(() => setCopied(false), 1600);
  };
  return (
    <button
      onClick={handle}
      className={`px-2 py-0.5 rounded text-[9px] font-black uppercase border transition whitespace-nowrap
        ${copied ? "border-green-600 text-green-400" : "border-slate-600 text-slate-500 hover:border-orange-500 hover:text-orange-400"}`}
    >
      {copied ? "‚úì Copied" : "Copy"}
    </button>
  );
};

const StatusPill = ({ status }) => {
  const map = {
    Active:     "bg-green-900/30 text-green-400 border-green-800",
    Refunded:   "bg-red-900/30 text-red-400 border-red-900",
    Transferred:"bg-blue-900/30 text-blue-400 border-blue-800",
    Cancelled:  "bg-slate-700/30 text-slate-400 border-slate-600",
  };
  return (
    <span className={`px-2 py-0.5 rounded text-[9px] font-black uppercase border ${map[status] || map.Active}`}>
      {status}
    </span>
  );
};

const Toast = ({ msg, type }) => (
  <div className={`fixed top-5 right-5 z-50 px-5 py-3 rounded-xl text-sm font-semibold shadow-2xl flex items-center gap-2 animate-pulse
    ${type === "error" ? "bg-red-700 border border-red-500" : "bg-green-700 border border-green-500"}`}>
    {type === "error" ? "‚úó" : "‚úì"} {msg}
  </div>
);

// ‚îÄ‚îÄ‚îÄ Refund Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const RefundModal = ({ order, onClose, onConfirm }) => {
  const [reason, setReason] = useState("customer_request");
  const [refundType, setRefundType] = useState("full");
  const [partialAmt, setPartialAmt] = useState("");

  const refundAmount = refundType === "full"
    ? `$${order.orderTotal.toFixed(2)}`
    : (partialAmt ? `$${parseFloat(partialAmt).toFixed(2)}` : "$0.00");

  const handleConfirm = () => {
    if (refundType === "partial" && (!partialAmt || parseFloat(partialAmt) <= 0)) {
      alert("Please enter a valid partial refund amount.");
      return;
    }
    onConfirm({ reason, refundType, amount: refundAmount });
  };

  return (
    <div className="fixed inset-0 bg-black/75 z-50 flex items-center justify-center p-4">
      <div className="bg-slate-800 border border-slate-600 rounded-2xl p-8 max-w-md w-full shadow-2xl">
        <div className="flex justify-between items-start mb-5">
          <div>
            <h2 className="text-lg font-black">Process Refund</h2>
            <p className="text-slate-400 text-xs mt-1">
              Order <span className="font-mono text-orange-400">{order.orderNumber}</span> ‚Äî {order.firstName} {order.lastName}
            </p>
          </div>
          <button onClick={onClose} className="text-slate-500 hover:text-white text-xl font-bold leading-none">√ó</button>
        </div>

        {/* Order Summary */}
        <div className="bg-slate-900 rounded-xl p-4 mb-5 space-y-2 text-sm border border-slate-700">
          <div className="flex justify-between"><span className="text-slate-400">Order Total</span><span className="font-bold">${order.orderTotal.toFixed(2)}</span></div>
          <div className="flex justify-between"><span className="text-slate-400">Customer</span><span>{order.firstName} {order.lastName}</span></div>
          <div className="flex justify-between"><span className="text-slate-400">Email</span><span className="text-xs">{order.email}</span></div>
          <div className="flex justify-between"><span className="text-slate-400">Pass Type</span><span>{order.itemCategories}</span></div>
          <div className="flex justify-between"><span className="text-slate-400">Passes</span><span>{order.passes.length}</span></div>
        </div>

        {/* Refund Type */}
        <div className="mb-4">
          <label className="block text-xs font-black text-slate-500 uppercase tracking-wider mb-2">Refund Type</label>
          <div className="flex gap-3">
            <button
              onClick={() => setRefundType("full")}
              className={`flex-1 py-2 rounded-lg text-sm font-bold border transition ${refundType === "full" ? "border-orange-500 text-orange-400 bg-orange-900/20" : "border-slate-600 text-slate-400 hover:border-slate-400"}`}
            >
              Full Refund
            </button>
            <button
              onClick={() => setRefundType("partial")}
              className={`flex-1 py-2 rounded-lg text-sm font-bold border transition ${refundType === "partial" ? "border-orange-500 text-orange-400 bg-orange-900/20" : "border-slate-600 text-slate-400 hover:border-slate-400"}`}
            >
              Partial Refund
            </button>
          </div>
        </div>

        {refundType === "partial" && (
          <div className="mb-4">
            <label className="block text-xs font-black text-slate-500 uppercase tracking-wider mb-2">Refund Amount (USD)</label>
            <div className="relative">
              <span className="absolute left-3 top-3 text-slate-400">$</span>
              <input
                type="number"
                value={partialAmt}
                onChange={e => setPartialAmt(e.target.value)}
                max={order.orderTotal}
                step="0.01"
                placeholder="0.00"
                className="w-full pl-7 pr-4 py-2.5 rounded-lg text-sm focus:border-orange-500 transition"
              />
            </div>
          </div>
        )}

        {/* Reason */}
        <div className="mb-5">
          <label className="block text-xs font-black text-slate-500 uppercase tracking-wider mb-2">Reason</label>
          <select value={reason} onChange={e => setReason(e.target.value)} className="w-full p-3 rounded-lg text-sm focus:border-orange-500 transition">
            <option value="customer_request">Customer Request</option>
            <option value="event_cancelled">Event Cancelled</option>
            <option value="technical_issue">Technical Issue / Stream Failure</option>
            <option value="duplicate_charge">Duplicate Charge</option>
            <option value="billing_error">Billing Error</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div className="bg-red-900/20 border border-red-800 rounded-lg p-3 mb-5 text-xs text-red-300 leading-relaxed">
          ‚ö†Ô∏è Confirming will immediately revoke the fan's access and initiate a refund of <strong>{refundAmount}</strong> to their original payment method.
        </div>

        <div className="flex gap-3">
          <button onClick={onClose} className="flex-1 py-3 rounded-lg border border-slate-600 text-slate-400 hover:text-white font-bold text-sm transition">Cancel</button>
          <button onClick={handleConfirm} className="flex-1 py-3 rounded-lg bg-red-600 hover:bg-red-500 text-white font-bold text-sm transition">
            Confirm Refund
          </button>
        </div>
      </div>
    </div>
  );
};

// ‚îÄ‚îÄ‚îÄ Transfer Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const TransferModal = ({ order, onClose, onConfirm }) => {
  const [newEmail, setNewEmail] = useState("");
  const [confirmEmail, setConfirmEmail] = useState("");
  const [selectedPass, setSelectedPass] = useState("all");
  const [note, setNote] = useState("");

  const handle = () => {
    if (!newEmail) { alert("Please enter a recipient email address."); return; }
    if (newEmail !== confirmEmail) { alert("Email addresses do not match."); return; }
    onConfirm({ newEmail, selectedPass, note });
  };

  return (
    <div className="fixed inset-0 bg-black/75 z-50 flex items-center justify-center p-4">
      <div className="bg-slate-800 border border-slate-600 rounded-2xl p-8 max-w-md w-full shadow-2xl">
        <div className="flex justify-between items-start mb-5">
          <div>
            <h2 className="text-lg font-black">Transfer Ticket / Pass</h2>
            <p className="text-slate-400 text-xs mt-1">
              From <span className="text-white font-semibold">{order.firstName} {order.lastName}</span> ({order.email})
            </p>
          </div>
          <button onClick={onClose} className="text-slate-500 hover:text-white text-xl font-bold leading-none">√ó</button>
        </div>

        <div className="mb-4">
          <label className="block text-xs font-black text-slate-500 uppercase tracking-wider mb-2">Pass to Transfer</label>
          <select value={selectedPass} onChange={e => setSelectedPass(e.target.value)} className="w-full p-3 rounded-lg text-sm focus:border-orange-500 transition">
            <option value="all">All Passes in this Order ({order.passes.length})</option>
            {order.passes.map(p => (
              <option key={p.passId} value={p.passId}>
                {p.passId.substring(0, 28)}‚Ä¶ {p.reservedSeats ? `(${p.reservedSeats})` : ""}
              </option>
            ))}
          </select>
        </div>

        <div className="mb-4">
          <label className="block text-xs font-black text-slate-500 uppercase tracking-wider mb-2">Recipient Email</label>
          <input
            type="email"
            value={newEmail}
            onChange={e => setNewEmail(e.target.value)}
            placeholder="recipient@example.com"
            className="w-full p-3 rounded-lg text-sm focus:border-orange-500 transition"
          />
        </div>

        <div className="mb-4">
          <label className="block text-xs font-black text-slate-500 uppercase tracking-wider mb-2">Confirm Recipient Email</label>
          <input
            type="email"
            value={confirmEmail}
            onChange={e => setConfirmEmail(e.target.value)}
            placeholder="re-enter email to confirm"
            className={`w-full p-3 rounded-lg text-sm transition
              ${confirmEmail && newEmail !== confirmEmail ? "border-red-600" : "focus:border-orange-500"}`}
          />
          {confirmEmail && newEmail !== confirmEmail && (
            <p className="text-red-400 text-xs mt-1">Email addresses do not match.</p>
          )}
        </div>

        <div className="mb-5">
          <label className="block text-xs font-black text-slate-500 uppercase tracking-wider mb-2">Internal Note (Optional)</label>
          <textarea
            value={note}
            onChange={e => setNote(e.target.value)}
            rows={2}
            placeholder="e.g. Fan requested transfer to family member"
            className="w-full p-3 rounded-lg text-sm focus:border-orange-500 transition resize-none"
          />
        </div>

        <div className="bg-blue-900/20 border border-blue-800 rounded-lg p-3 mb-5 text-xs text-blue-300 leading-relaxed">
          ‚úâÔ∏è The recipient will receive a confirmation email with instructions to access their transferred pass. The original owner's access will be revoked.
        </div>

        <div className="flex gap-3">
          <button onClick={onClose} className="flex-1 py-3 rounded-lg border border-slate-600 text-slate-400 hover:text-white font-bold text-sm transition">Cancel</button>
          <button onClick={handle} className="flex-1 py-3 rounded-lg bg-orange-600 hover:bg-orange-500 text-white font-bold text-sm transition">
            Transfer Pass
          </button>
        </div>
      </div>
    </div>
  );
};

// ‚îÄ‚îÄ‚îÄ Order Detail View ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const OrderDetail = ({ order: initial, onBack }) => {
  const [order, setOrder] = useState(initial);
  const [showRefund, setShowRefund] = useState(false);
  const [showTransfer, setShowTransfer] = useState(false);
  const [toast, setToast] = useState(null);

  const notify = (msg, type = "success") => {
    setToast({ msg, type });
    setTimeout(() => setToast(null), 4000);
  };

  const handleRefund = ({ reason, refundType, amount }) => {
    setOrder(o => ({ ...o, status: "Refunded" }));
    setShowRefund(false);
    notify(`${refundType === "full" ? "Full" : "Partial"} refund of ${amount} processed. Reason: ${reason.replace(/_/g, " ")}.`);
  };

  const handleTransfer = ({ newEmail, selectedPass, note }) => {
    const entry = {
      date: new Date().toISOString(),
      from: order.email,
      to: newEmail,
      passId: selectedPass === "all" ? `All passes (${order.passes.length})` : selectedPass,
      action: "Transfer",
      note: note || null,
    };
    setOrder(o => ({ ...o, transferHistory: [entry, ...o.transferHistory] }));
    setShowTransfer(false);
    notify(`Pass successfully transferred to ${newEmail}.`);
  };

  const handleResend = () => {
    notify(`Confirmation email resent to ${order.email}.`);
  };

  const isRefunded = order.status === "Refunded";

  const rows = [
    { label: "Id",                   value: order.id },
    { label: "User Id",              value: order.userId, link: `https://admin.hudl.com/user/${order.userId}` },
    { label: "First Name",           value: order.firstName },
    { label: "Last Name",            value: order.lastName },
    { label: "Email",                value: order.email },
    { label: "Order Total",          value: `$${order.orderTotal.toFixed(2)}` },
    { label: "Currency",             value: order.currency },
    { label: "Item Categories",      value: order.itemCategories },
    { label: "Created At",           value: order.createdAt },
    { label: "Updated At",           value: order.updatedAt },
    { label: "Deleted At",           value: order.deletedAt || "‚Äî" },
    { label: "Source",               value: order.source },
    { label: "Original Ticket Group",value: order.originalTicketGroup || "N/A" },
  ];

  return (
    <div>
      {toast && <Toast msg={toast.msg} type={toast.type} />}
      {showRefund   && <RefundModal   order={order} onClose={() => setShowRefund(false)}   onConfirm={handleRefund} />}
      {showTransfer && <TransferModal order={order} onClose={() => setShowTransfer(false)} onConfirm={handleTransfer} />}

      {/* Breadcrumb */}
      <nav className="text-xs text-slate-500 mb-5 flex gap-1.5 items-center flex-wrap">
        <a href="index.html" className="hover:text-white transition">Home</a>
        <span>/</span>
        <button onClick={onBack} className="hover:text-white transition">Tickets Lookup</button>
        <span>/</span>
        <span className="text-slate-300">{order.firstName} {order.lastName}</span>
      </nav>

      {/* Header row */}
      <div className="flex flex-wrap items-start justify-between gap-4 mb-6">
        <div>
          <h2 className="text-2xl font-black flex flex-wrap items-center gap-3">
            {order.firstName} {order.lastName}
            <StatusPill status={order.status} />
          </h2>
          <p className="text-slate-400 text-xs mt-1 font-mono">
            Order # <span className="text-orange-400">{order.orderNumber}</span>
            &nbsp;¬∑&nbsp;{order.email}
            &nbsp;¬∑&nbsp;{order.itemCategories}
            &nbsp;¬∑&nbsp;<span className="font-bold text-slate-200">${order.orderTotal.toFixed(2)}</span>
          </p>
        </div>

        {/* Action buttons */}
        <div className="flex gap-2 flex-wrap">
          <button
            onClick={handleResend}
            className="flex items-center gap-2 px-4 py-2 rounded-lg border border-slate-600 text-slate-300 hover:text-white hover:border-slate-400 text-sm font-bold transition"
          >
            ‚úâÔ∏è Resend Email
          </button>
          {!isRefunded && (
            <>
              <button
                onClick={() => setShowTransfer(true)}
                className="flex items-center gap-2 px-4 py-2 rounded-lg border border-blue-700 text-blue-400 hover:bg-blue-900/20 text-sm font-bold transition"
              >
                ‚Üó Transfer Pass
              </button>
              <button
                onClick={() => setShowRefund(true)}
                className="flex items-center gap-2 px-4 py-2 rounded-lg border border-red-700 text-red-400 hover:bg-red-900/20 text-sm font-bold transition"
              >
                ‚Ü© Process Refund
              </button>
            </>
          )}
          {isRefunded && (
            <span className="px-4 py-2 rounded-lg border border-slate-700 text-slate-600 text-sm font-bold italic">
              Order Refunded ‚Äî no further actions
            </span>
          )}
        </div>
      </div>

      {/* Two-column content */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">

        {/* Order Details Table */}
        <div className="card rounded-xl overflow-hidden">
          <div className="bg-slate-800 px-4 py-3 border-b border-slate-700">
            <h3 className="text-[11px] font-black uppercase tracking-widest text-slate-400">Order Details</h3>
          </div>
          <table className="w-full text-xs">
            <thead>
              <tr className="bg-slate-800/40 text-slate-500 uppercase text-[9px] font-black tracking-wider border-b border-slate-700/50">
                <th className="px-4 py-2 text-left w-40">Property</th>
                <th className="px-4 py-2 text-left">Value</th>
                <th className="px-4 py-2 w-16"></th>
              </tr>
            </thead>
            <tbody className="divide-y divide-slate-800/60">
              {rows.map(r => (
                <tr key={r.label}>
                  <td className="px-4 py-2 font-bold text-slate-300 whitespace-nowrap">{r.label}</td>
                  <td className="px-4 py-2 text-slate-400 break-all">
                    {r.link
                      ? <a href={r.link} target="_blank" rel="noreferrer" className="text-blue-400 hover:underline">{r.value}</a>
                      : r.value}
                  </td>
                  <td className="px-4 py-2 text-right"><CopyBtn text={r.value} /></td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>

        {/* Right column */}
        <div className="space-y-6">

          {/* Associated Passes */}
          <div className="card rounded-xl overflow-hidden">
            <div className="bg-slate-800 px-4 py-3 border-b border-slate-700 flex justify-between items-center">
              <h3 className="text-[11px] font-black uppercase tracking-widest text-slate-400">Associated Passes</h3>
              <span className="text-[9px] font-black text-orange-400 bg-orange-900/20 border border-orange-800 px-2 py-0.5 rounded-full">
                {order.passes.length}
              </span>
            </div>
            <table className="w-full text-xs">
              <thead>
                <tr className="bg-slate-800/40 text-slate-500 uppercase text-[9px] font-black tracking-wider border-b border-slate-700/50">
                  <th className="px-4 py-2 text-left">Pass Id</th>
                  <th className="px-4 py-2 text-left">Source</th>
                  <th className="px-4 py-2 text-left">Reserved Seats</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-slate-800/60">
                {order.passes.map(p => (
                  <tr key={p.passId}>
                    <td className="px-4 py-2 font-mono text-blue-400 break-all">
                      <span title={p.passId}>{p.passId.substring(0, 22)}‚Ä¶</span>
                    </td>
                    <td className="px-4 py-2 text-slate-400">{p.source}</td>
                    <td className="px-4 py-2 text-slate-400">{p.reservedSeats || "‚Äî"}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          {/* Transfer History */}
          <div className="card rounded-xl overflow-hidden">
            <div className="bg-slate-800 px-4 py-3 border-b border-slate-700">
              <h3 className="text-[11px] font-black uppercase tracking-widest text-slate-400">Transfer History</h3>
            </div>
            <div className="p-4">
              {order.transferHistory.length === 0 ? (
                <p className="text-slate-600 text-xs italic">No share or transfer history.</p>
              ) : (
                <div className="space-y-3">
                  {order.transferHistory.map((t, i) => (
                    <div key={i} className="bg-slate-900/60 border border-slate-700/50 rounded-lg p-3 text-xs space-y-1">
                      <div className="flex justify-between items-center">
                        <span className="font-black text-blue-400 uppercase tracking-wide">‚Üó {t.action}</span>
                        <span className="text-slate-500">{fmt(t.date)}</span>
                      </div>
                      <div><span className="text-slate-500">From: </span><span className="text-slate-300">{t.from}</span></div>
                      <div><span className="text-slate-500">To: </span><span className="text-slate-300">{t.to}</span></div>
                      <div className="text-slate-600 truncate">
                        Pass: {typeof t.passId === "string" && t.passId.length > 30 ? t.passId.substring(0, 30) + "‚Ä¶" : t.passId}
                      </div>
                      {t.note && <div className="text-slate-500 italic">Note: {t.note}</div>}
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>

        </div>
      </div>
    </div>
  );
};

// ‚îÄ‚îÄ‚îÄ Main Search View ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SearchView = ({ orders, onSelectOrder }) => {
  const [tab, setTab] = useState("order");
  const [orderInput, setOrderInput] = useState("");
  const [textInput, setTextInput] = useState("");
  const [dateInput, setDateInput] = useState("");
  const [results, setResults] = useState(null);

  const searchByOrder = () => {
    const q = orderInput.trim().toLowerCase();
    if (!q) return;
    setResults(orders.filter(o => o.orderNumber.toLowerCase() === q));
  };

  const searchByText = () => {
    const q = textInput.trim().toLowerCase();
    const d = dateInput;
    if (!q && !d) return;
    setResults(orders.filter(o => {
      const matchText = !q
        || o.firstName.toLowerCase().includes(q)
        || o.lastName.toLowerCase().includes(q)
        || `${o.firstName} ${o.lastName}`.toLowerCase().includes(q)
        || o.email.toLowerCase().includes(q)
        || o.orderNumber.toLowerCase().includes(q);
      const matchDate = !d || o.createdAt.startsWith(d);
      return matchText && matchDate;
    }));
  };

  const onKey = (e, fn) => { if (e.key === "Enter") fn(); };

  const totalOrders   = orders.length;
  const activeOrders  = orders.filter(o => o.status === "Active").length;
  const refundedCount = orders.filter(o => o.status === "Refunded").length;

  return (
    <div>
      {/* Header */}
      <div className="flex justify-between items-start mb-8 pb-4 border-b border-slate-700">
        <div>
          <h1 className="text-2xl font-black tracking-tight">
            Hudl Tickets <span className="text-orange-500">Lookup</span>
          </h1>
          <p className="text-slate-400 text-sm mt-1">
            Search and manage fan ticket purchases ‚Äî refunds, transfers, and full order details.
          </p>
        </div>
        <a href="index.html" className="text-sm text-slate-400 hover:text-white font-bold transition whitespace-nowrap">
          ‚Üê Back to Menu
        </a>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-3 gap-4 mb-8">
        <div className="card p-5 rounded-xl">
          <div className="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-1">Total Orders</div>
          <div className="text-3xl font-black">{totalOrders}</div>
        </div>
        <div className="card p-5 rounded-xl">
          <div className="text-green-500 text-[10px] font-black uppercase tracking-widest mb-1">Active Passes</div>
          <div className="text-3xl font-black">{activeOrders}</div>
        </div>
        <div className="card p-5 rounded-xl">
          <div className="text-red-400 text-[10px] font-black uppercase tracking-widest mb-1">Refunds Issued</div>
          <div className="text-3xl font-black">{refundedCount}</div>
        </div>
      </div>

      {/* Search Panel */}
      <div className="card rounded-t-xl border-b-0">
        <div className="flex border-b border-slate-700">
          <button
            onClick={() => { setTab("order"); setResults(null); }}
            className={`px-6 py-4 text-sm font-bold transition border-b-2 -mb-px
              ${tab === "order" ? "border-orange-500 text-orange-400" : "border-transparent text-slate-400 hover:text-white"}`}
          >
            üîç Search by Order Number
          </button>
          <button
            onClick={() => { setTab("text"); setResults(null); }}
            className={`px-6 py-4 text-sm font-bold transition border-b-2 -mb-px
              ${tab === "text" ? "border-orange-500 text-orange-400" : "border-transparent text-slate-400 hover:text-white"}`}
          >
            üë§ Search by Name / Email / Date
          </button>
        </div>

        <div className="p-6">
          {tab === "order" ? (
            <div>
              <p className="text-[10px] text-slate-500 uppercase font-black tracking-wider mb-3">
                Search ticket groups by an order number
              </p>
              <div className="flex gap-3 flex-wrap">
                <input
                  type="text"
                  value={orderInput}
                  onChange={e => setOrderInput(e.target.value)}
                  onKeyDown={e => onKey(e, searchByOrder)}
                  placeholder="e.g. gh4b4t24mxqe"
                  className="flex-1 min-w-48 p-3 rounded-lg text-sm focus:border-orange-500 transition"
                />
                <button
                  onClick={searchByOrder}
                  className="bg-orange-600 hover:bg-orange-500 text-white px-6 py-3 rounded-lg font-bold text-sm transition shadow-lg shadow-orange-900/20"
                >
                  Search by Order Number
                </button>
              </div>
              <p className="text-[10px] text-slate-600 mt-2">
                Try: <button onClick={() => { setOrderInput("gh4b4t24mxqe"); }} className="text-slate-500 hover:text-orange-400 font-mono transition">gh4b4t24mxqe</button>
                &nbsp;¬∑&nbsp;
                <button onClick={() => { setOrderInput("xy9z8w76vuqr"); }} className="text-slate-500 hover:text-orange-400 font-mono transition">xy9z8w76vuqr</button>
                &nbsp;¬∑&nbsp;
                <button onClick={() => { setOrderInput("ab1c2d34efgh"); }} className="text-slate-500 hover:text-orange-400 font-mono transition">ab1c2d34efgh</button>
              </p>
            </div>
          ) : (
            <div>
              <p className="text-[10px] text-slate-500 uppercase font-black tracking-wider mb-3">
                Search ticket groups by name, email, or purchase date
              </p>
              <div className="flex gap-3 flex-wrap">
                <input
                  type="text"
                  value={textInput}
                  onChange={e => setTextInput(e.target.value)}
                  onKeyDown={e => onKey(e, searchByText)}
                  placeholder="Fan name or email address‚Ä¶"
                  className="flex-1 min-w-56 p-3 rounded-lg text-sm focus:border-orange-500 transition"
                />
                <input
                  type="date"
                  value={dateInput}
                  onChange={e => setDateInput(e.target.value)}
                  className="p-3 rounded-lg text-sm focus:border-orange-500 transition w-44"
                />
                <button
                  onClick={searchByText}
                  className="bg-orange-600 hover:bg-orange-500 text-white px-6 py-3 rounded-lg font-bold text-sm transition shadow-lg shadow-orange-900/20"
                >
                  Search
                </button>
              </div>
              <p className="text-[10px] text-slate-600 mt-2">
                Try: <button onClick={() => setTextInput("janet")} className="text-slate-500 hover:text-orange-400 transition">janet</button>
                &nbsp;¬∑&nbsp;
                <button onClick={() => setTextInput("gmail.com")} className="text-slate-500 hover:text-orange-400 transition">gmail.com</button>
                &nbsp;¬∑&nbsp;
                <button onClick={() => setDateInput("2026-02-10")} className="text-slate-500 hover:text-orange-400 transition">2026-02-10</button>
              </p>
            </div>
          )}
        </div>
      </div>

      {/* Results Table */}
      {results !== null && (
        <div className="card rounded-b-xl border-t border-slate-700/50 overflow-hidden">
          {results.length === 0 ? (
            <div className="p-10 text-center text-slate-500 text-sm">
              <div className="text-4xl mb-3">üéüÔ∏è</div>
              <p className="font-bold text-slate-400 mb-1">No orders found</p>
              <p className="text-xs">Double-check the order number or try a different search term.</p>
            </div>
          ) : (
            <>
              <div className="px-4 py-2 bg-slate-800/30 border-b border-slate-700/50 text-xs text-slate-500">
                {results.length} result{results.length !== 1 ? "s" : ""} found
              </div>
              <table className="w-full text-sm">
                <thead className="bg-slate-800/50 text-slate-400 uppercase text-[9px] font-black tracking-widest border-b border-slate-700">
                  <tr>
                    <th className="px-4 py-3 text-left">Order #</th>
                    <th className="px-4 py-3 text-left">Fan Name</th>
                    <th className="px-4 py-3 text-left">Email</th>
                    <th className="px-4 py-3 text-left">Pass Type</th>
                    <th className="px-4 py-3 text-left">Total</th>
                    <th className="px-4 py-3 text-left">Purchased</th>
                    <th className="px-4 py-3 text-left">Status</th>
                    <th className="px-4 py-3 text-right">Actions</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-slate-800">
                  {results.map(o => (
                    <tr key={o.orderNumber}>
                      <td className="px-4 py-3 font-mono text-orange-400 text-xs">{o.orderNumber}</td>
                      <td className="px-4 py-3 font-bold whitespace-nowrap">{o.firstName} {o.lastName}</td>
                      <td className="px-4 py-3 text-slate-400 text-xs">{o.email}</td>
                      <td className="px-4 py-3 text-xs text-slate-300">{o.itemCategories}</td>
                      <td className="px-4 py-3 font-mono font-bold text-xs">${o.orderTotal.toFixed(2)}</td>
                      <td className="px-4 py-3 text-slate-400 text-xs whitespace-nowrap">{fmtDate(o.createdAt)}</td>
                      <td className="px-4 py-3"><StatusPill status={o.status} /></td>
                      <td className="px-4 py-3 text-right">
                        <button
                          onClick={() => onSelectOrder(o)}
                          className="px-3 py-1.5 rounded-lg bg-slate-700 hover:bg-slate-600 text-xs font-bold transition"
                        >
                          View Details ‚Üí
                        </button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </>
          )}
        </div>
      )}
    </div>
  );
};

// ‚îÄ‚îÄ‚îÄ App Root ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const App = () => {
  const [orders, setOrders] = useState(MOCK_ORDERS);
  const [selected, setSelected] = useState(null);

  // Keep the search view's order list in sync when an order detail mutates it
  const handleSelectOrder = (order) => setSelected(order);
  const handleBack = () => setSelected(null);

  return (
    <div className="p-6 sm:p-8 max-w-6xl mx-auto">
      {selected
        ? <OrderDetail order={selected} onBack={handleBack} />
        : <SearchView orders={orders} onSelectOrder={handleSelectOrder} />
      }
    </div>
  );
};

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
